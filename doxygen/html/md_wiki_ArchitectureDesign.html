<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>parallel-preprocessor: Software design</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">parallel-preprocessor
   &#160;<span id="projectnumber">0.3.0.f176d79</span>
   </div>
   <div id="projectbrief">MPI distributive and multithreading massively parallel geometry processor     for large scale CAE and machine learning, by Qingfeng Xia, UKAEA, 2019</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_wiki_ArchitectureDesign.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Software design </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Architecture design</h2>
<ul>
<li>cross-platform: All selected components must be cross-platform. In this early development stage, only baseline platform is documented: 64 bit Ubuntu 18.04 with a c++17 compiler and python3 <br  />
</li>
<li>modular and extensible: cover all aspects of CAE<ul>
<li>parallel preprocessing infrastructure which can be used in scenarios other than CAE</li>
<li>CAD preprocessing, shape check, fixing, imprinting, etc</li>
<li>parallel meshing</li>
<li>solver setup.</li>
</ul>
</li>
<li>scalable: from single node multiple-threading to MPI on super-computer</li>
<li>pipeline style workflow: VTK style tensorflow style graph topology may be supported in the future</li>
<li>python3 language binding: based on pybind11 javascript binding is also under consideration</li>
<li>Industry standard compliant: <br  />
<ul>
<li>standard CAD exchange format: STEP P214 (AP242 is not supported by OpenCASCADE yet)</li>
<li>JTOpen: there is no open source library available</li>
<li>FreeCAD/BREP</li>
</ul>
</li>
<li>UTF8 encoding is assumed and stored in <code>std::string</code> Note: 1. this may work for macos and Linux of utf8 locale;<ol type="1">
<li><code>filesystem::path::string()</code> not <code>filesystem::path::u8string()</code></li>
</ol>
</li>
</ul>
<h2>Modular design</h2>
<p>Folder structure corresponds to modular design, inspired by FreeCAD project. see CodeStructure.md for description for each header file.</p>
<ul>
<li>third-party/Base: type system and BaseClass for c++ (extracted from FreeCAD project)</li>
<li>PropertyContainer: heterogeneous container based on <code>std::any</code>, may be replaced with FreeCAD's in the future</li>
<li><a class="el" href="namespacePPP.html">PPP</a>: framework infrastructure for parallel preprocessing, depends only on STL and some header-only third-party libraries.</li>
<li><a class="el" href="namespaceGeom.html" title="This file is adapted from FreeCAD project.">Geom</a>: geometry processing relies on OCCT, including 2D surface meshing (facetizing)</li>
<li>Mesh: 3D volume meshing (planned yet coded)</li>
<li>third-party: json, catch2, loguru, SGeom, etc</li>
<li>test: unit test</li>
<li>python: python wrapping and python script executables</li>
<li>scripts: utility script</li>
<li>data: testing data</li>
</ul>
<p>Note: any namespace and module name of FreeCAD module should be avoided. E.g. <a class="el" href="namespacePPP.html">PPP</a> module's function can be mapped to <code>App</code> but <code><a class="el" href="namespacePPP.html">PPP</a></code> is used insrtead; <code>Base</code> module should be compatible with FreeCAD. This arrangement can help into the future to integrate with FreeCAD at source code level.</p>
<h2>Data driven pipeline design</h2>
<p>This software has the data-driven design, users can just write a json configuration file to build up the pipeline and specify parameters to each processor. There is no need to program in C++, if existing processors are sufficient. Each action has a default pipeline, a series of geometry processors, see example in the generated <code>config.json</code>.</p>
<p>json file is the input configuration format. Pipeline can be built from the json configuration, i.e. a list of class names. Each processor can be weaked by processor specific parameters and global parameters such tolerance.</p>
<p><code>Parameter&lt;T&gt;</code> mappable to json repr. Furthermore, enum types can be converted into json string, such as, ShapeType , which has string name identical to FreeCAD ShapeType enum.</p>
<h2>User interface design</h2>
<ul>
<li>Console: basic command line with json as input configuration file</li>
<li>Python: bindings for Python3 by <code>pybind11</code></li>
<li>Gui: Qt based, embedded into each module</li>
<li>Web: web interface for remote operator</li>
</ul>
<p>Note: UI design is yet completed, some untested code are not merged into the repository yet</p>
<hr  />
<h2>Component design</h2>
<h3>OCCT as the first CAD kernel</h3>
<p>OCCT is the only available industry-strenth LGPL open source CAD kernel.</p>
<p>OCCT official does not have a python binding, therefore, C++ is chosen as the programming language.</p>
<p>cmake OpenCascade detection</p><ul>
<li>FreeCAD provided</li>
<li>OpenCASCADE official cmake config, provided by package "occt-misc" from Ubuntu PPA <code>/usr/lib/cmake/opencascade/OpenCASCADEConfig.cmake</code> each module has <code>/usr/lib/cmake/opencascade/OpenCASCADEApplicationFrameworkTargets.cmake</code></li>
</ul>
<p>Note: geometry exported form one CAD kernel then imported to another CAD kernel may cause some problems.</p>
<p>parallel-preprocessor, should work without X-windows, but some modules (data-exchange, XCAF) of OpenCASCADE has dep on X-windows</p>
<h3>Most classes are header only</h3>
<p>hpp for header only, h and cpp for other pairs (currently my header only is still called *.h, it will be split into h and cpp after API stabalised) .</p>
<h3>Third-party libraries license</h3>
<p>Only MIT and BSD open source libraries can be included into this LGPLv2 repository</p><ul>
<li>magic_enum.hpp: MIT License</li>
<li>half.hpp: BSD</li>
<li><a href="https://math.nist.gov/MatrixMarket/mmio-c.html">mm_io.h and mm_io.cpp</a>: NIST as a US government institution, so these 2 files should be in public domain</li>
<li>pybind_json.hpp: BSD 3-Clause</li>
</ul>
<p>software components that will be downloaded during compiling, e.g. git submodules</p><ul>
<li><a href="https://github.com/ukaea/SGeom">SGeom</a>: <a class="el" href="namespaceGeom.html" title="This file is adapted from FreeCAD project.">Geom</a> module extracted from Salome project LGPLv2.1</li>
<li><a href="https://github.com/nlohmann/json">nhohmann json c++ lib</a>: MIT</li>
<li><a href="https://github.com/emilk/loguru">loguru logging for C++</a> public domain</li>
<li><a href="https://github.com/catchorg/Catch2/blob/master/LICENSE.txt">catch2: unit test</a>: Boost Software License 1.0</li>
</ul>
<p>software it links:</p><ul>
<li>OpenCASCDE: LGPLv2.1</li>
<li>intel TBB: MIT</li>
<li>boost libraries: boost license, like MIT/BSD</li>
<li>QT: LGPLv2.1 </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
