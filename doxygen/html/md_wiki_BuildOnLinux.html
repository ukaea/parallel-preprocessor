<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>parallel-preprocessor: Build on Linux</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">parallel-preprocessor
   &#160;<span id="projectnumber">0.3.0.f176d79</span>
   </div>
   <div id="projectbrief">MPI distributive and multithreading massively parallel geometry processor     for large scale CAE and machine learning, by Qingfeng Xia, UKAEA, 2019</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_wiki_BuildOnLinux.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Build on Linux </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>packages needed to build from source</h2>
<p>note: <b>package name are debian based</b>, see installation section for RedHat based operation systems</p>
<ul>
<li>C++17 compiler is also needed.</li>
<li>essential build tool: cmake, git, etc</li>
<li><code>libtbb2-dev</code>: thread pool</li>
<li>OpenCASCADE (<code>libocct*-dev</code> and <code>occt-misc</code>) can be installed from freecad-daily PPA ubuntu has opencascade with dbgsym, but its version is too outdated. <a href="https://launchpad.net/ubuntu/+source/opencascade">https://launchpad.net/ubuntu/+source/opencascade</a></li>
<li><code>python3-dev</code> pybind11 is now a submodule</li>
</ul>
<h3>git submodule init</h3>
<p>Some github repo will be downloaded when running <code>git submodule init</code> </p><div class="fragment"><div class="line">third-party/catch2</div>
<div class="line">third-party/loguru</div>
<div class="line">Geom/third-party/SGeom</div>
</div><!-- fragment --><p>In case, download submodule from github by git is not possible, you need to manuallly download the zip file and unzip into the expected position. For example, browse to third-party and click the link to catch2, redirected to catch2 github repo, download the source in zip file. unzip as our <code>src/third-party/catch2</code>.</p>
<h3>Optional dependencies:</h3>
<ul>
<li><code>boost</code>: if C++17 compiler is not available, <code>boost::any</code> and <code>boost::filesystem</code></li>
<li><code>freecad</code> or <code>freecad-daily</code>: to view result and test, using the freecad-python3</li>
<li><code>doxygen</code>: for in-source documentation generation</li>
<li><code>zlib</code> and zipiso++: for zipped stream IO: used by FreeCAD project, simulate java.zipfile API</li>
</ul>
<p>Future dependencies:</p><ul>
<li><code>openmpi, libscotch, libhypre</code>, can be installed with fenics from Fenics PPA</li>
<li><code>Qt</code> for GUI 3D viewer</li>
</ul>
<p>If you follow the official guide and you can build FreeCAD-daily 0.19 (python3 is strongly recommended), you should get the OpenCASCADE 7.3 dev from their PPA repo.</p>
<p>There are some third-party libraries already integrated into the source code tree, see more details on <a class="el" href="md_wiki_CodeStructure.html">software design wiki page</a></p>
<hr  />
<h2>Ubuntu 18.04 and 20.04, Debian 10</h2>
<p>The dependency is similar as Ubuntu and Debian. Ubuntu 18.04 must install OpenCASCADE from FreeCAD PPA, but Ubuntu 20.04 has occt in official repository (version 7.3.3). Since March 2021, FreeCAD 0.19 PPA has occt 7.5 available. It is recommended to user FreeCAD 0.19 and occt 7.5.</p>
<div class="fragment"><div class="line"># this repo contains submodule:</div>
<div class="line"># for user clone this repo, git should automatically download all submodules, </div>
<div class="line"># if not, or not sure, just run</div>
<div class="line">git submodule update --init --recursive</div>
<div class="line"># otherwise, you will be warmed by cmake to run this command</div>
<div class="line"> </div>
<div class="line"># install compulsory dependencies</div>
<div class="line">sudo apt-get install git cmake doxygen ccache g++</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">source /etc/lsb-release  # help to detect ubuntu version, </div>
<div class="line"># $(lsb_release -c -s)</div>
<div class="line">if [ &quot;$DISTRIB_CODENAME&quot; == &quot;bionic&quot; ]; then</div>
<div class="line"># add freecad-stable or freecad-daily ppa (for ubuntu 18.04)</div>
<div class="line">add-apt-repository ppa:freecad-maintainers/freecad-stable  &amp;&amp;  apt-get update</div>
<div class="line">apt-get install -y freecad</div>
<div class="line">fi</div>
<div class="line"> </div>
<div class="line">if [ &quot;$DISTRIB_CODENAME&quot; == &quot;focal&quot; ]; then</div>
<div class="line">echo &quot;libocct 7.3 can be installed from official repo&quot;</div>
<div class="line">fi</div>
<div class="line"> </div>
<div class="line">if [ &quot;$DISTRIB_CODENAME&quot; == &quot;buster&quot; ]; then</div>
<div class="line">echo &quot;libocct 7.4 can be installed from official Debian repo&quot;</div>
<div class="line">fi</div>
<div class="line"> </div>
<div class="line">sudo apt-get install libocct*-dev occt*</div>
<div class="line">sudo apt-get install python3-dev libtbb-dev</div>
<div class="line"> </div>
<div class="line"># libocct some module depends on Xwindows system, although</div>
<div class="line">sudo apt-get install libx11-dev libxmu-dev libxi-dev</div>
<div class="line"> </div>
<div class="line">############ optional ######################</div>
<div class="line">sudo apt-get install libboost-dev</div>
<div class="line"> </div>
<div class="line"># Qt interface,  see the gitlab CI scrypt for the most updated </div>
<div class="line"> </div>
<div class="line"># pybind11 will be download if not found on system, there is no need to install</div>
<div class="line">#if you can prefer a system-wide install, uncomment the following line</div>
<div class="line"># sudo apt-get install python3-pybind11 pybind11-dev</div>
<div class="line"> </div>
<div class="line"># read zipped data folder,  cmake has FindZLIB, version 1.5, optional </div>
<div class="line">#sudo apt-get install zlib-dev  libzipiso++-dev</div>
</div><!-- fragment --><h2>Fedora30+</h2>
<p>Fedora 31 and 32 have OpenCASCADE in repository, there is no needs to compile from source.</p>
<ol type="1">
<li>install compiler and tools <div class="fragment"><div class="line">#this script is extracted from dockerfile</div>
<div class="line"> </div>
<div class="line"># you must update before any yum install or add a repo</div>
<div class="line">#fedora30 has the default python as python3</div>
<div class="line"># `copr-cli` is needed to to add copr repo</div>
<div class="line">yum install copr-cli -y &amp;&amp; yum update -y </div>
<div class="line"> </div>
<div class="line"># g++ 9.2 for f30 high enough, there is no need to install boost-devel</div>
<div class="line">yum install g++ cmake make git doxygen -y</div>
<div class="line"> </div>
<div class="line"># python3</div>
<div class="line">yum install python3 python3-devel  -y </div>
<div class="line"> </div>
<div class="line"># optionally, install version 2.x of zipios++,  https://github.com/Zipios/Zipios</div>
<div class="line"># not in use for the moment</div>
<div class="line"># yum install zipios zipios-devel -y</div>
<div class="line"> </div>
<div class="line">############## optional ####################</div>
<div class="line"># Qt5 is optional for GUI operation</div>
<div class="line">yum install qt5-devel qt5-qtwebsockets-devel qt5-qtwebsockets -y</div>
</div><!-- fragment --></li>
<li>Install opencascade 7.4 from package repository</li>
</ol>
<p>For fedora 30+ since Jan 2020, there are freecad (python3) and opencascade 7.4 in repository to install</p>
<div class="fragment"><div class="line"># opencascade 7.4 package  for fedora 30+ is available  </div>
<div class="line">yum install opencascade-draw, opencascade-foundation,  opencascade-modeling,  opencascade-ocaf \</div>
<div class="line">    opencascade-visualization opencascade-devel freecad -y</div>
</div><!-- fragment --><h2>For OSs without OCCT packages, compile OpenCASCADE 7.x from source</h2>
<p>For centos7 and centos7, the Dockerfile has updated unix shell command to install compiler toolchain.</p>
<p>Download the opencascade source code and compile from source, Compile opencascade if not available in package repository, e.g. centos 7/8, see the "Dockerfile_centos" file for updated instructions.</p>
<p>To get the latest source code from <a href="https://www.opencascade.com/">OCCT official website</a>, you need register (free of charge). Registered user may setup public ssh key and get readonly access to the occt repo <code>git clone -b V7_4_0p1 gitolite@git.dev.opencascade.org:occt occt</code> <a href="https://old.opencascade.com/doc/occt-7.4.0/overview/html/occt_dev_guides__git_guide.html">https://old.opencascade.com/doc/occt-7.4.0/overview/html/occt_dev_guides__git_guide.html</a></p>
<p>To get the release source code, this can be downloaded by wget from OCCT official repo, manually using webbrowser. browse to <a href="https://git.dev.opencascade.org/gitweb/?p=occt.git">https://git.dev.opencascade.org/gitweb/?p=occt.git</a> in the tags list, click the the latest release version and download from the newly open page, "tar.gz" or "zip".</p>
<p>Alternative, wget or git clone from OCCT's github mirror : <a href="https://github.com/Open-Cascade-SAS/OCCT/">https://github.com/Open-Cascade-SAS/OCCT/</a></p>
<div class="fragment"><div class="line"># wget from opencascade.org may not work any more, use github instead</div>
<div class="line">#wget &quot;http://git.dev.opencascade.org/gitweb/?p=occt.git;a=snapshot;h=V7_4_0p1;sf=tgz&quot; -O occt.tar.gz</div>
<div class="line">#tar -xzf occt.tar.gz</div>
<div class="line">wget -O occt.zip  https://github.com/Open-Cascade-SAS/OCCT/archive/refs/tags/V7_5_0.zip</div>
<div class="line">mkdir occt &amp;&amp; unzip -qq occt.zip -d occt</div>
<div class="line"> </div>
<div class="line">cd occt</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake .. -DUSE_TBB=ON -DBUILD_MODULE_Draw=OFF</div>
<div class="line">make -j$(nproc)</div>
<div class="line">sudo make install</div>
<div class="line"># by default install to the prefix: /usr/local/</div>
</div><!-- fragment --><h2>Compile parallel-preprocessor</h2>
<p>CMake build system is employed to simplify cross-platform development</p>
<div class="fragment"><div class="line">git clone https://github.com/UKAEA/parallel-preprocessor.git</div>
<div class="line">git submodule update --init --recursive</div>
<div class="line"> </div>
<div class="line">#git clone (outside docker is easier for this non-public repo, to avoid trouble in authentication)</div>
<div class="line"> </div>
<div class="line">cd parallel-preprocessor</div>
<div class="line">#</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake .. -DPYTHON_EXECUTABLE:FILEPATH=$(which python3) -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">make -j$(nproc)</div>
</div><!-- fragment --><h2>Notes on compilers supported</h2>
<p>Tested compilers: g++ 7.x, g++8.x, clang 6 (needs CMake 3.13+ ) on ubuntu 18.04</p>
<p>To use clang tool chain, <code>-T llvm</code> cmake command option may be needed to specify the linker app: lld-link ``<code>bash &lt;h1&gt;ubuntu 18.04, needs</code>-T llvm` cmake -T llvm .. -DPYTHON_EXECUTABLE:FILEPATH=$(which python3) -DCMAKE_BUILD_TYPE=Release</p>
<h1>ubuntu 20.04, clang++ is v10, pybind11 must be v2.6 to work</h1>
<p>CXX=clang++ cmake .. -DPYTHON_EXECUTABLE:FILEPATH=$(which python3) -DCMAKE_BUILD_TYPE=Release</p>
<div class="fragment"><div class="line">clang++ shares header files and libstdc++.so with G++</div>
<div class="line"> </div>
<div class="line">Error with pybind11 when compiled by clang++10, which has been fixed in latest pybind11 (v2.6).</div>
</div><!-- fragment --><p>/usr/include/pybind11/pybind11.h:1010:9: error: no matching function for call to 'operator delete' ::operator delete(p, s); ^~~~~~~~~~~~~~~~~ ```</p>
<p>User can either sticks with g++ or upgrade pybind11 installation to fix this error.</p>
<hr  />
<h2>Installation after building</h2>
<h3>install by "sudo make install"</h3>
<p><code>sudo make install</code> to install to <code>/usr</code> or any other defined by <code>CMAKE_INSTALL_PREFIX</code> <code>sudo make uninstall</code> in the build folder to uninstall.</p>
<h3>Use after built the deb/rpm package</h3>
<h4>Generate deb/rpm package</h4>
<p>After successfully build this software from source using cmake, <code>make package</code> will generate the platform binary package, deb or rpm (currently, only Ubuntu 18.04 and fedora 30+). see [./Packaging.md] for more details.</p>
<h4>Install parallel processor package</h4>
<p>Precompiled binary packages may be provided in the future.</p>
<p>Platform package rpm and deb has been generated in the build directory, install it. <code>sudo rpm -Uhv parallel-preprocessor*</code> on fedora/RedHat systems or <code>sudo dpkg -i parallel-preprocessor*</code> on debian/ubuntu</p>
<h3>Use without system-wide installation</h3>
<p>Without installation, this software can be evaluated by running <a href="./python/geomPipeline.py">geomPipeline.py path_to_geometry_file</a>, after building from source.</p>
<p>Note: change directory to the folder containing geomPipeline.py is not necessary, if user has put full path of <code>parallel-preprocessor/build/bin/</code> folder into user path. For example, by editing PATH variable in <code>~/.bashrc</code> on Ubuntu, it will just work as installed program.</p>
<p>Just append the <code>bin</code> folder to user <code>path</code> in <code>~/.bashrc</code>, that is all. you should be able to imprint geometry by <code>geomPipeline.py input_geometry_path</code>. And also append <code>build/lib</code> to <code>LD_LIBRARY_PATH</code></p>
<p>This is the recommended way in this development stage, then it is easier to pull and build the latest source. Super user privilege is needed. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
